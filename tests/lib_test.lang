import "lib/test" (*)

// ============================================================================
// Test Definition
// ============================================================================

testRun("basic assertion passes", fun() -> {
    assert(true)
})

testRun("assertEquals with integers", fun() -> {
    assertEquals(42, 42)
})

testRun("assertEquals with strings", fun() -> {
    assertEquals("hello", "hello")
})

testRun("assertEquals with lists", fun() -> {
    assertEquals([1, 2, 3], [1, 2, 3])
})

// ============================================================================
// Option Assertions
// ============================================================================

testRun("assertSome passes on Some", fun() -> {
    assertSome(Some(42))
})

testRun("assertZero passes on Zero", fun() -> {
    assertZero(Zero)
})

// ============================================================================
// Result Assertions
// ============================================================================

testRun("assertOk passes on Ok", fun() -> {
    assertOk(Ok(42))
})

testRun("assertFail passes on Fail", fun() -> {
    assertFail(Fail("error"))
})

// ============================================================================
// HTTP Mocks
// ============================================================================

testRun("mockHttp sets up mock", fun() -> {
    mockHttp("/api/users", { status: 200, body: "{}", headers: [] })
    // Mock is set - in real usage, httpGet would return the mocked response
    assert(true)
})

testRun("mockHttpOff clears mocks", fun() -> {
    mockHttp("/api/*", { status: 200, body: "{}", headers: [] })
    mockHttpOff()
    // After mockHttpOff, HTTP calls would go to real endpoints
    assert(true)
})

// ============================================================================
// Env Mocks
// ============================================================================

testRun("mockEnv sets up mock", fun() -> {
    mockEnv("TEST_VAR", "test_value")
    // In real usage, sysEnv("TEST_VAR") would return Some("test_value")
    assert(true)
})

testRun("mockEnvOff clears mocks", fun() -> {
    mockEnv("TEST_VAR", "test_value")
    mockEnvOff()
    assert(true)
})

// ============================================================================
// File Mocks
// ============================================================================

testRun("mockFile sets up mock", fun() -> {
    mockFile("/tmp/test.txt", Ok("file content"))
    // In real usage, fileRead("/tmp/test.txt") would return Ok("file content")
    assert(true)
})

testRun("mockFileOff clears mocks", fun() -> {
    mockFile("/tmp/*", Ok("content"))
    mockFileOff()
    assert(true)
})

print("lib/test tests completed")
