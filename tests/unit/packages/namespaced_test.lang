import "lib/test" (*)
import "./testlib" as t

// =============================================
// NAMESPACED IMPORTS: import "path" as alias
// Tests: types, functions, ADTs, trait instances, extension methods
// =============================================

testRun("Namespaced: access type", fun() -> {
    p: t.Point = { x: 1, y: 2 }
    assert(p.x == 1)
    assert(p.y == 2)
})

testRun("Namespaced: access function", fun() -> {
    p1: t.Point = { x: 1, y: 2 }
    p2: t.Point = { x: 3, y: 4 }
    result = t.add(p1, p2)
    assert(result.x == 4)
    assert(result.y == 6)
})

testRun("Namespaced: access ADT constructor", fun() -> {
    c = t.Radius(5.0)
    assertEquals(c, t.Radius(5.0))
})

testRun("Namespaced: trait instance for type alias (Semigroup)", fun() -> {
    p1: t.Point = { x: 1, y: 2 }
    p2: t.Point = { x: 3, y: 4 }
    result = p1 <> p2
    assert(result.x == 4)
    assert(result.y == 6)
})

testRun("Namespaced: trait instance for ADT (Semigroup)", fun() -> {
    c1 = t.Radius(5.0)
    c2 = t.Radius(3.0)
    result = c1 <> c2
    assertEquals(result, t.Radius(8.0))
})

testRun("Namespaced: extension method for ADT (area)", fun() -> {
    c = t.Radius(5.0)
    a = c.area()
    // pi * 25 â‰ˆ 78.54
    assert(a > 78.0)
    assert(a < 79.0)
})

testRun("Namespaced: extension method for ADT (diameter)", fun() -> {
    c = t.Radius(5.0)
    d = c.diameter()
    assert(d == 10.0)
})

testRun("Namespaced: function using imported lib (sqrt)", fun() -> {
    p: t.Point = { x: 3, y: 4 }
    d = t.distance(p)
    assert(d == 5.0)
})

testRun("Namespaced: field access on type alias", fun() -> {
    p: t.Point = { x: 100, y: 200 }
    assert(p.x == 100)
    assert(p.y == 200)
})

testRun("Namespaced: extension method for type alias (scale)", fun() -> {
    p: t.Point = { x: 2, y: 3 }
    scaled = p.scale(2)
    assert(scaled.x == 4)
    assert(scaled.y == 6)
})

testRun("Namespaced: extension method for type alias (magnitude)", fun() -> {
    p: t.Point = { x: 3, y: 4 }
    mag = p.magnitude()
    assert(mag == 5.0)
})
